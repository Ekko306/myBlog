---
title: æ¯•ä¸šè®¾è®¡4
categories:
  - ä¸ªäººæå‡
  - æ¯•ä¸šè®¾è®¡
thumbnailImage: 'http://cdn.ekko306.top/cover/Red%20Pill%20Blues%20%28Deluxe%29.jpg'
date: 2021-11-30 17:07:58
tags:
coverImage:
coverCaption:
gallery:
---

æ¯•ä¸šè®¾è®¡ï¼ŒASP.NETçš„Blazor
<!-- more -->
<!-- toc -->
# ç®€ä»‹
Signalæ˜¯åŸºäºå®¢æˆ·ç«¯çš„ASP.NETæ¡†æ¶Webåº”ç”¨ï¼Œç±»ä¼¼äºReactï¼Œä½†æ˜¯æœ‰ASP.Netçš„ç‰¹ç‚¹
https://docs.microsoft.com/zh-cn/aspnet/core/tutorials/choose-web-ui?view=aspnetcore-5.0

ä¸‹é¢ä¸‰ä¸ªé¡¹ç›®ä¸‰ä¸ªåœ°å€
# ç”Ÿæˆä½ çš„ç¬¬ä¸€ä¸ªBlazoråº”ç”¨
ğŸ¦„ï¼š[githubåœ°å€:BlazorApp](https://github.com/Ekko306/SignalR_Practice/tree/main/BlazorApp)
ğŸ½ï¼š[æ–‡æ¡£åœ°å€](https://dotnet.microsoft.com/learn/aspnet/blazor-tutorial/intro)
æ–‡æ¡£å¾ˆç®€å•ï¼Œæœ€åŸºæœ¬çš„å®¢æˆ·ç«¯å®ç°ä¸€ä¸ªåº”ç”¨ï¼Œå¤§éƒ¨åˆ†è¦å®æˆ˜å§
## Intro
ç”¨Blazoræ„å»ºç¬¬ä¸€ä¸ªweb åº”ç”¨
## Download and install
- å®‰è£….NET SDK ï¼ˆ64-bitï¼‰
- æ£€æŸ¥dotnetæŒ‡ä»¤
## Create your app
ç”¨å‘½ä»¤åˆ›å»º
```
dotnet new blazorserver -o BlazorApp --no-https
```
è¿™ä¸ªå‘½ä»¤åˆ›å»ºä¸€ä¸ªBlazorAppçš„æ–‡ä»¶å¤¹çš„é¡¹ç›®

å¿«é€Ÿçœ‹æ–‡ä»¶å¤¹ç»“æ„ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç®€å•çš„ä»‹ç»ï¼š
- `Program.cs`æ˜¯æ•´ä¸ªappçš„å…¥å£ï¼Œå¼€å¯æœåŠ¡å™¨ï¼Œç„¶åé…ç½®åº”ç”¨æœåŠ¡å’Œä¸­é—´ä»¶
- `App.razor`æ˜¯appçš„æ ¹ç»„ä»¶
- `Pages`æ–‡ä»¶å¤¹åŒ…å«ä¸€äº›åº”ç”¨çš„webä¾‹å­
- åœ¨`Properties`æ–‡ä»¶å¤¹é‡Œçš„`launchSettings.json`å®šä¹‰æœ¬åœ°ç¯å¢ƒçš„é…ç½®ï¼Œç«¯å£å·è‡ªåŠ¨ç”Ÿæˆå¹¶ä¸”ä¿å­˜åœ¨è¿™é‡Œé¢

è®°ä½æ–‡ä»¶è·¯å¾„ï¼Œåé¢è¿›è¡Œä¸€äº›ç®€å•çš„æ“ä½œ

## Run your app
- æ‰§è¡Œ`dotnet watch`å¯åŠ¨åº”ç”¨ï¼Œç„¶åä»£ç æ”¹å˜çš„æ—¶å€™æ›´æ–°ï¼Œç”¨`ctrl + c`åœæ­¢
- çœ‹åœ°å€`http://localhost:<port number>` æ¥å¯åŠ¨
- çœ‹åˆ°é¡µé¢å°±æ˜¯æˆåŠŸå¯åŠ¨äº†

è¿™ä¸ªé¡µé¢æ˜¯Pages/Index.razorå±•ç¤ºçš„

åŒ…å«äº†homePageçš„ä»£ç ï¼Œå¹¶ä¸”å±•ç¤ºâ€œHello worldâ€

è¿˜åŒ…å«ä¸€ä¸ªSurveyPromptç»„ä»¶åŒ…å«è°ƒæŸ¥é“¾æ¥ï¼ˆæœ€ç®€å•çš„ç»„ä»¶ï¼‰


## Try the counter
åˆ°counteré¡µé¢ï¼Œç„¶åç‚¹å‡»`click me`å»åœ¨æ²¡æœ‰é¡µé¢åˆ·æ–°å¢åŠ è®¡æ•°ï¼Œä¸€èˆ¬å¢åŠ è®¡æ•°éœ€è¦jsï¼Œä½†æ˜¯è¿™é‡Œåœ¨Blazorç”¨C#ã€‚

å¯ä»¥åœ¨Pages/Counter.razoré‡Œæ‰¾åˆ°Counterç»„ä»¶çš„å®šä¹‰



```
@page "/counter"

<PageTitle>Counter</PageTitle>

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>

<button class="btn btn-primary" @onclick="IncrementCount">Click me</button>

@code {
    private int currentCount = 0;

    private void IncrementCount()
    {
        currentCount++;
    }
}
```

ä¸€ä¸ªåœ¨`/counter`çš„è·¯ç”±å±•ç¤ºæ˜¾ç¤º

æ¯æ¬¡ç‚¹å‡»`Click me`ï¼š
- onclickäº‹ä»¶è§¦å‘
- IncrementCountæ–¹æ³•è¢«è°ƒç”¨
- currentCountè®¡æ•°è¢«å¢åŠ 
- ç»„ä»¶è¢«æ¸²æŸ“å±•ç¤ºæ›´æ–°çš„è®¡æ•°



## Add a component
æ¯ä¸ªrazorçš„UIç»„ä»¶éƒ½å¯ä»¥è¢«å¤ç”¨

æ‰“å¼€Page/Index.razoræ–‡ä»¶ï¼Œæ·»åŠ `<Counter />`å‘ç°è¢«å¤ç”¨äº†

## Modify a component 
ç»„ä»¶å‚æ•°ç”¨attrubutesæˆ–è€…å­å…ƒç´ æŒ‡å®šï¼Œå¯ä»¥è®¾ç½®å­ç»„ä»¶çš„å±æ€§

åœ¨Counterç»„ä»¶ä¸ŠæŒ‡å®šä¸€ä¸ªå‚æ•°æ¥æŒ‡å®šæ¯æ¬¡ç‚¹å‡»çš„æ—¶å€™å¦‚ä½•å¢åŠ ã€


Pages/Counter.razorï¼š
- å¢åŠ ä¸€ä¸ªpublic property ï¼Œç”¨\[Paramerte\]å«åšIncrementAmount
- æ”¹å˜IncrementCountæ–¹æ³•ï¼Œæ¥å¢åŠ IncrementAmountçš„å€¼

Pages/Index.razorï¼š
- å¢åŠ `<Counter IncrementAmount="10" />`,æ¥è®©æ¯æ¬¡å¢åŠ 10 
- Indexç°åœ¨æ¯æ¬¡ç‚¹å‡»ä¹‹åå¢åŠ 10
- ä½†æ˜¯Counterè¿˜æ˜¯å¢åŠ 1



## Next steps
æ„å»ºäº†æœ€åŸºæœ¬çš„ï¼Œä¸‹ä¸€æ­¥å¯ä»¥å°è¯•æ„å»º`todo list app`


# ç”ŸæˆBlazorå¾…åŠäº‹é¡¹åˆ—è¡¨åº”ç”¨
ï¼ˆææ··äº†æŠŠä¸Šä¸‹ä¸¤ä¸ªé¡¹ç›®å†™æˆäº†ä¸€ä¸ªBlazorAppï¼‰ï¼ˆæ²¡æœ‰TodoListï¼‰
ğŸ¦„ï¼š[githubåœ°å€:BlazorApp](https://github.com/Ekko306/SignalR_Practice/tree/main/BlazorApp)
ğŸ½ï¼š[æ–‡æ¡£åœ°å€](https://docs.microsoft.com/zh-cn/aspnet/core/tutorials/build-a-blazor-app?view=aspnetcore-3.1&pivots=server)
## å¿…å¤‡æ¡ä»¶
.NET 3.1 SDK
## åˆ›å»ºBlazoråº”ç”¨
`dotnet new blazorserver -o TodoList`
## ç”Ÿæˆå¾…åŠäº‹é¡¹åˆ—è¡¨Blazoråº”ç”¨
### 1 æ·»åŠ TodoRazorç»„ä»¶
`dotnet new razorcomponent -n Todo -o Pages`

- -nameæŒ‡å®šæ–°ç»„ä»¶åå­—
- -outputæŒ‡å®šPagesæ–‡ä»¶å¤¹
- Razorç»„ä»¶æ–‡ä»¶åè¦æ±‚é¦–å­—æ¯å¤§å†™

#### 2 æ·»åŠ è·¯ç”±
`Pages/Todo.razor`:
æ·»åŠ `@page "/todo"`

### 3 æ·»åŠ åˆ°å¯¼èˆªæ 
Shared/NavMenu.razor ç»„ä»¶ç”¨äºåº”ç”¨çš„å¸ƒå±€ï¼Œå‡å°‘é‡å¤ï¼Œurlä¼šå±•ç¤ºNavLinkï¼Œæ·»åŠ todo

```
<ul class="nav flex-column">

    ...

    <li class="nav-item px-3">
        <NavLink class="nav-link" href="todo">
            <span class="oi oi-list-rich" aria-hidden="true"></span> Todo
        </NavLink>
    </li>
</ul>
```

### 4 è¿è¡Œ
æ‰§è¡Œ`dotnet watch run`ï¼Œä¹‹åæ›´æ”¹åŒæ­¥æ›´æ–°

### 5 å¢åŠ TodoItem.csæ–‡ä»¶

åœ¨æ ¹ç›®å½•æ·»åŠ `TodoItem.cs`ï¼ˆTodoListæ–‡ä»¶å¤¹ï¼‰ï¼Œä¹‹åå†razoré¡µé¢å¯ä»¥ç”¨TodoItemç±»

```
public class TodoItem
{
    public string Title { get; set; }
    public bool IsDone { get; set; }
}
```


### 6 Todo.razoræ–‡ä»¶åº”ç”¨

- åœ¨`@code`ä¸ºå•æ¿é¡¹æ·»åŠ ä¸€ä¸ªå­—æ®µï¼ŒTodoç»„ä»¶ä½¿ç”¨æ­¤å­—æ®µç»´æŠ¤çŠ¶æ€
- ç„¶åå¯ä»¥ç”¨TodoItemäº†

```
@page "/todo"

<h1>Todo</h1>

<ul>
    @foreach (var todo in todos)
    {
        <li>@todo.Title</li>
    }
</ul>

@code {
    private List<TodoItem> todos = new();
}
```

### 7 æ·»åŠ æŒ‰é’®å’Œåˆ—è¡¨

```
<input placeholder="Something todo" />
<button>Add todo</button>
```


### 8 ä¿å­˜æ–‡ä»¶
é¡¹ç›®è‡ªåŠ¨æ›´æ–°

### 9 ç‚¹å‡»æŒ‰é’®
æ²¡ååº”ï¼Œæ²¡æœ‰onClickæ–¹æ³•
### 10 æ·»åŠ æ–¹æ³•

å¢åŠ `private void AddTodo()`


### 11 æ·»åŠ æ–°å¾…åŠæ ‡é¢˜
```
private string newTodo

// ç„¶åç»‘å®š
<input placeholder="Something todo" @bind="newTodo" />
```


### 12 æ›´æ–°é€»è¾‘
```
private void AddTodo()
{
	if (!string.IsNullOrWhiteSpace(newTodo))
	{
		todos.Add(new TodoItem { Title = newTodo });
		newTodo = string.Empty;
	}
}
```

### 13 é‡æ–°ç”Ÿæˆ

### 14æ¯ä¸ªæ ‡é¢˜å¯ä»¥ç¼–è¾‘

```cs
<ul>
    @foreach (var todo in todos)
    {
        <li>
            <input type="checkbox" @bind="todo.IsDone" />
            <input @bind="todo.Title" />
        </li>
    }
</ul>
```

### 15 æ›´æ–°å¾…åŠæ•°é‡
`<h1>Todo (@todos.Count(todo => !todo.IsDone))</h1>`


### 16 æ•´ä¸ªTodoç»„ä»¶

```
@page "/todo"

<h1>Todo (@todos.Count(todo => !todo.IsDone))</h1>

<ul>
    @foreach (var todo in todos)
    {
        <li>
            <input type="checkbox" @bind="todo.IsDone" />
            <input @bind="todo.Title" />
        </li>
    }
</ul>

<input placeholder="Something todo" @bind="newTodo" />
<button @onclick="AddTodo">Add todo</button>

@code {
    private List<TodoItem> todos = new();
    private string newTodo;

    private void AddTodo()
    {
        if (!string.IsNullOrWhiteSpace(newTodo))
        {
            todos.Add(new TodoItem { Title = newTodo });
            newTodo = string.Empty;
        }
    }
}
```
# ä½¿ç”¨Blazorçš„SignalR
è§SignalRï¼Œæ¯•ä¸šè®¾è®¡5
